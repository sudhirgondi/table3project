<h1><%= @interest.name %> events in your area</h1>
<div id="map" style="width: 100%; height: 400px;"></div>

<%= gmaps("markers" => {"data" => @json, "options" => {"list_container" => "markers_list" } }) %>



<div class="span2.5">
  <h4><%= @interest.name %> Fanatics</h4>
  <% @interest_users.each do |iuser| %>
    <%= iuser.first_name %> 
    <%= iuser.last_name %></br>
  <% end %>
</div>

<div class="span7">
  <h4>Events</h4>
  <table class="table">
    <thead>
      <tr>
        <th>Event Name</th>
        <th>Event Start Date</th>
        <th>Event Starts at</th>
        <th>Invitation status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @interest_events.each do |ievent| %>
        <tr>
          <td><%= link_to ievent.name, event_path(ievent) %></td>
          <td><%= ievent.start_date.strftime('%A %B %d, %Y') %></td>
          <td><%= ievent.start_time.strftime('%H:%M %p') %></td>
          <% if @invited_to_events.include?(ievent.id) %>
            <td>Invited</td> 
          <% else %> 
            <td>Not invited</td>
          <% end %>

          <% if @joined_events.include?(ievent.id) %>
            <td>Joined</td>
          <% elsif @invited_to_events.include?(ievent.id) %>
            <td><%= button_to 'Join', invite_path(ievent.event_attendant, :status => 3), method: :patch, class: 'btn btn-small btn-success' %> </td>
          <% else %> 
            <td><%= button_to 'Join', invites_path(:invite =>{:user_id => current_user.id, :event_id => ievent.id, :attendee_status => 3}), method: :post, class: 'btn btn-small btn-success' %> </td>
          <% end %>
      <% end %>
    </tbody>
  </table>
</div>

<div class="span2">
    <h4>Locate on the map</h4>
  </br>
  </br>
  <p id="markers_list"> </p>

</div>



